<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="INFO">

    <Properties>
        <Property name="log_charset">UTF-8</Property>
        <Property name="filename">library</Property>
        <Property name="log_path">E:\library\library\logs</Property>
        <Property name="library_log_encoding">UTF-8</Property>
        <Property name="library_log_size">200MB</Property>
        <Property name="data_level">INFO</Property>
        <Property name="library_log_time">5d</Property>
        <Property name="log_pattern">%-d{yyyy-MM-dd HH:mm:ss} %-5r[%t] [%-5p] %c %x - %m%n</Property>
    </Properties>

    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="${log_pattern}"/>
            <ThresholdFilter level="info" onMatch="ACCEPT" onMismatch="DENY"/>
        </Console>

        <RollingRandomAccessFile
                name="LIBRARY_FILE"
                fileName="${log_path}/${filename}.log"
                filePattern="${log_path}/${filename}_%d{yyyy-MM-dd}_%i.log.gz">
            <PatternLayout pattern="[%style{%d{yyyy-MM-dd HH:mm:ss.SSS}}{bright, green}] [%-5p][%t][%c{1}] %m%n"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="${library_log_size}"/>
            </Policies>
        </RollingRandomAccessFile>

        <RollingFile
                name="RollingFileError"
                fileName="${log_path}/error.log"
                filePattern="${log_path}/${filename}-ERROR-%d{yyyy-MM-dd}_%i.log.gz">
            <ThresholdFilter level="error" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="${log_pattern}"/>
            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="10MB"/>
            </Policies>
            <DefaultRolloverStrategy max="15"/>
        </RollingFile>
    </Appenders>

    <Loggers>
        <AsyncLogger name="org.springframework" level="info" additivity="false">
            <AppenderRef ref="Console"/>
        </AsyncLogger>

        <AsyncLogger name="org.mybatis" level="info" additivity="false">
            <AppenderRef ref="Console"/>
        </AsyncLogger>

        <AsyncLogger name="com.library.admin" level="INFO" additivity="false">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="LIBRARY_FILE"/>
            <AppenderRef ref="RollingFileError"/>
        </AsyncLogger>

        <AsyncRoot level="info">
            <AppenderRef ref="Console"/>
            <AppenderRef ref="LIBRARY_FILE"/>
            <AppenderRef ref="RollingFileError"/>
        </AsyncRoot>
    </Loggers>

</Configuration>
